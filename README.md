# classfy-photo-by-location
classfy photos from mobile phone by location in China which generated with GPS data from the EXIF information.  Put it into different directory.

按照手机照片里的EXIF中的GPS数据对照片，按日期（一般是月）和地点进行分类。

项目目的是解决自己和父母手机里数万张超过100G照片的分类的问题。

其实mac系统的照片功能相当优秀，但没有mac，对mac的文件组织方式也不熟悉，还是选择将手机照片导出后，按时间地点分类，然后保存在两个移动硬盘上的方法备份。

采用中国国家地理中心的数据对行政区进行分类。精确到县，并针对长名称进行一定简化。

photocls.py是主程序
map_data_new.json是数据文件
findlocation.py是个测试，根据输入的GPS数据反查地名，方法是三角测距。

对不同地区的招牌采取不同的分类方式。本人在四川成都，因此以四川为本省，成都为本市。
因为在外地旅游或出差的照片，时间和地点上都很好确定，照片数量也比较多且连续，其实比较容易分类。
而在本省或本市地方短期旅游出行的照片，数量在100张以内，地点很散碎，因此不容易分类。
按本人多年备份照片的习惯，对照片进行了如下分析：

类型一：非本省区域，连续日期在同一城市，以月+省+地级市（含直辖市、港澳）为分类名称，比如【201812上海】，【201808辽宁大连】，【201709昆明大理丽江】等。

类型二：本省区域，非本市区域，连续日期在不同城市，以月+市+县（含区，县级市等），比如【201811广元剑阁】等。

类型三：本市区域，分城区和非城区，城区以月+成都分类。非城区以月+成都+区县命名，如【201807成都都江堰】等

类型四：无GPS数据、无法确定地址的照片，如微信传入图，以月+未分类分类，如【201901未分类】。

本程序分三个部分。
1 通过照片的EXIF中的GPS数据，通过map_data_new.json的数据反查地址信息。并提取照片绝对路径，建立数据表。
2 通过DataFrame模块的group功能，对数据表进行归类和排序，确定归类的文件夹名称。
3 用shutil模块的copy2功能，把照片拷贝到指定文件夹。

个人初学作品，基本满足自用。用小米笔记本，测试4800张照片在anaconda36中Spyder下运行，大概2分钟左右。

不足之处很多。
1 非参数化，读取照片的文件夹数据需要在程序里手工修改。
2 GPS反查地址用的全遍历，效率不是很高。
3 对DataFrame的Group方法迭代原理不是很明确。
4 只有国内地址数据，国外的招牌会被分类成距离最近的县市。比如日本的照片被分类为延边州。但出国时间不多且照片集中，因此只需手工修改即可。
5 对跨月的连续照片会被分到不同的文件夹，比如2018年11月28日——2018年12月5日在上海的照片会被分为【201811上海】和【201812上海】两个文件夹。
6 对零散的照片会产生很多文件夹，需要之后一一手工删除或合并。
7 没有AI识别功能，有大堆宠物照片不需要按年月分类。

总的来说，初学python，还是很有意思，至少父母电脑里堆积成山的照片，终于有动力去进行分类了。
